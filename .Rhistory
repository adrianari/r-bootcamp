par(mfrow = c(2, 2))
qplot(y = UNIDIR, x = air_temperature, xlab = "Air temperature", data = join_zaehlung_wetter, facets = ~ TAGESZEIT, col = TAGESZEIT, ylim = c(0,250),alpha=I(0.05))
histogram(UNIDIR ~ air_temperature, data=join_zaehlung_wetter)
histogram(air_temperature, data=join_zaehlung_wetter)
View(join_zaehlung_wetter)
histogram(UNIDIR ~ air_temperature, data=join_zaehlung_wetter)
histogram(UNIDIR, data=join_zaehlung_wetter)
histogram(UNIDIR ~ air_temperature, data=join_zaehlung_wetter)
histogram(air_temperature ~ UNIDIR, data=join_zaehlung_wetter)
?histogram
histogram(~ air_temperature, data=join_zaehlung_wetter)
histogram(~ UNIDIR, data=join_zaehlung_wetter)
?histogram
histogram(~ UNIDIR, data=join_zaehlung_wetter, endpoints = c(0,250))
histogram(~ air_temperature, data=join_zaehlung_wetter)
histogram(~ UNIDIR, data=join_zaehlung_wetter, endpoints = c(3,250))
histogram(~ air_temperature, data=join_zaehlung_wetter)
histogram(~ UNIDIR, data=join_zaehlung_wetter, endpoints = c(0,250))
histogram(~ air_temperature, data=join_zaehlung_wetter)
histogram(~ UNIDIR, data=join_zaehlung_wetter, to=250)
?histogram
histogram(~ air_temperature, data=join_zaehlung_wetter)
histogram(~ UNIDIR, data=join_zaehlung_wetter, from=0, to=250)
?histogram
histogram(~ air_temperature, data=join_zaehlung_wetter)
hist(~ UNIDIR, data=join_zaehlung_wetter, from=0, to=250)
histogram(~ air_temperature, data=join_zaehlung_wetter)
hist(UNIDIR, data=join_zaehlung_wetter, from=0, to=250)
?histogram
?hist
hist(join_zaehlung_wetter$UNIDIR)
histogram(~ air_temperature, data=join_zaehlung_wetter)
hist(join_zaehlung_wetter$UNIDIR, xlim = c(0,250))
hist(join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 50)
ggplot(join_zaehlung_wetter, aes(air_temperature, UNIDIR)) + geom_point(alpha = 0.05, color="darkblue") + ylim(c(0,250) + ggtitle("Does air temperature affect the number of bikers and pedestrians?") + xlab("Air temperature") + ylab("Total count of ped. + bikers"))
ggplot(join_zaehlung_wetter, aes(air_temperature, UNIDIR)) + geom_point(alpha = 0.05, color="darkblue") + ggtitle("Does air temperature affect the number of bikers and pedestrians?") + xlab("Air temperature") + ylab("Total count of ped. + bikers") + ylim(c(0,250))
histogram(~ air_temperature, data=join_zaehlung_wetter)
hist(join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 50)
?hist
histogram(~ air_temperature, data=join_zaehlung_wetter, xlim = c(0,15))
histogram(~ air_temperature, data=join_zaehlung_wetter, xlim = c(0,15))
histogram(join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 50)
?hist
histogram(~ air_temperature, data=join_zaehlung_wetter)
histogram(join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 50)
?hist
histogram(join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 50, xlab = "Number of pedestrians & bikers")
histogram(~ air_temperature, data=join_zaehlung_wetter)
histogram(join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour")
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
histogram(join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
# histogram(, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histPercent <- function(x, ...) {
H <- hist(x, plot = FALSE)
H$density <- with(H, 100 * density* diff(breaks)[1])
labs <- paste(round(H$density), "%", sep="")
plot(H, freq = FALSE, labels = labs, ylim=c(0, 1.08*max(H$density)),...)
}
histPercent(join_zaehlung_wetter$UNIDIR, col="gray")
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
# histogram(, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histPercent <- function(x, ...) {
H <- hist(x, plot = FALSE)
xlim= c(0,250)
H$density <- with(H, 100 * density* diff(breaks)[1])
labs <- paste(round(H$density), "%", sep="")
plot(H, freq = FALSE, labels = labs, ylim=c(0, 1.08*max(H$density)),...)
}
histPercent(join_zaehlung_wetter$UNIDIR, col="gray")
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
# histogram(, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histPercent <- function(x, ...) {
H <- hist(x, plot = FALSE)
H$density <- with(H, 100 * density* diff(breaks)[1])
labs <- paste(round(H$density), "%", sep="")
plot(H, xlim= c(0,250), freq = FALSE, labels = labs, ylim=c(0, 1.08*max(H$density)),...)
}
histPercent(join_zaehlung_wetter$UNIDIR, col="gray")
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
# histogram(, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histPercent <- function(x, ...) {
H <- hist(x, plot = FALSE)
H$density <- with(H, 100 * density* diff(breaks)[1])
labs <- paste(round(H$density), "%", sep="")
plot(H, xlim= c(0,250), freq = FALSE, labels = labs, ylim=c(0, 1.08*max(H$density)),...)
}
histPercent(join_zaehlung_wetter$UNIDIR, col="orange")
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
# histogram(, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histPercent <- function(x, ...) {
H <- hist(x, plot = FALSE)
H$density <- with(H, 100 * density* diff(breaks)[1])
labs <- paste(round(H$density), "%", sep="")
plot(H, xlim= c(0,250), , breaks = 50, freq = FALSE, labels = labs, ylim=c(0, 1.08*max(H$density)),...)
}
histPercent(join_zaehlung_wetter$UNIDIR, col="orange")
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
# histogram(, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histPercent <- function(x, ...) {
H <- hist(x, plot = FALSE)
H$density <- with(H, 100 * density* diff(breaks)[1])
labs <- paste(round(H$density), "%", sep="")
plot(H, xlim= c(0,250), , breaks = 50, freq = FALSE, labels = labs)
}
histPercent(join_zaehlung_wetter$UNIDIR, col="orange")
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
# histogram(, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histPercent <- function(x, ...) {
H <- hist(x, plot = FALSE)
H$density <- with(H, 100 * density* diff(breaks)[1])
labs <- paste(round(H$density), "%", sep="")
plot(H, xlim= c(0,250), , breaks = 50, freq = FALSE, labels = labs, ylim=c(0, 1.08*max(H$density)),...)
}
histPercent(join_zaehlung_wetter$UNIDIR, col="orange")
?plot
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
histogram(, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 50, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 125, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(1,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "")
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "Distribution of air temperature in Degree Celsius")
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(1,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "Air temperatur [°C]", main="Distribution of air temperature")
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(1,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "Air temperatur [°C]", main="Distribution of air temperature", breaks = 5)
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "Air temperatur [°C]", main="Distribution of air temperature", breaks = 10)
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "Air temperatur [°C]", main="Distribution of air temperature", breaks = 20)
histogram(~ air_temperature, data=join_zaehlung_wetter, xlab = "Air temperatur [°C]", main="Distribution of air temperature", breaks = 20)
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(1,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + TAGESZEIT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + TAGESZEIT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
View(aggregated_listFK)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
head(join_zaehlung_wetter)
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "01"] <- "Januar"
head(join_zaehlung_wetter)
head(join_zaehlung_wetter)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "01"] <- "Januar"
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "01"] <- "Januar"
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month <- as.character(join_zaehlung_wetter$month)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "01"] <- "Januar"
head(join_zaehlung_wetter)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-01"] <- "Januar"
head(join_zaehlung_wetter)
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month <- as.character(join_zaehlung_wetter$month)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-01"] <- "Januar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-02"] <- "Februar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-03"] <- "März"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-04"] <- "April"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-05"] <- "Mai"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-06"] <- "Juni"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-07"] <- "July"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-08"] <- "August"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-09"] <- "September"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-10"] <- "Oktober"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-11"] <- "November"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-12"] <- "Dezember"
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month[join_zaehlung_wetter)
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month[join_zaehlung_wetter$month)
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month[join_zaehlung_wetter$month)
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month)
head(join_zaehlung_wetter)
hibi <- histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
hibi
hibi$formula
hibi$as.table
hibi$call
hibi$x.num.limit
hibi$plot.args
hibi$plot.args
hibi$legend
hibi <- histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
hibi$legend
hibi$panel
hibi$strip
hibi$aspect.ratio
hibi$condlevels
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
qplot(y = UNIDIR, x = air_temperature, xlab = "Air temperature", data = join_zaehlung_wetter, facets = ~ FK_ZAEHLER, col = FK_ZAEHLER, ylim = c(0,250), alpha=I(0.05))
ggplot(data = join_zaehlung_wetter,
mapping = aes(y = UNIDIR,   #aes us easthetics
x = air_temperature)) +
geom_point() +
geom_smooth()
#humidity
plot(UNIDIR ~ humidity, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does humidity make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = " Humidity in ??")
par(mfrow = c(2, 2))
qplot(y = UNIDIR, x = humidity, data = join_zaehlung_wetter, facets = ~ TAGESZEIT, col = TAGESZEIT)
qplot(y = UNIDIR, x = humidity, data = join_zaehlung_wetter, facets = ~ FK_ZAEHLER, col = FK_ZAEHLER)
#precipitation
plot(UNIDIR ~ precipitation, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does precipitation make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = "Precipitation in ml")
join_zaehlung_wetter$UNIDIR_log <- log(join_zaehlung_wetter$UNIDIR)
histogram(~ join_zaehlung_wetter$UNIDIR_log, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE)
histogram(~ join_zaehlung_wetter$UNIDIR_log)
join_zaehlung_wetter$UNIDIR_log <- log(join_zaehlung_wetter$UNIDIR)
histogram(~ join_zaehlung_wetter$UNIDIR_log)
join_zaehlung_wetter$UNIDIR_log <- log(join_zaehlung_wetter$UNIDIR)
histogram(~ join_zaehlung_wetter$UNIDIR_log)
join_zaehlung_wetter$UNIDIR_log <- log(join_zaehlung_wetter$UNIDIR)
histogram(~ join_zaehlung_wetter$UNIDIR_log, main = "Unidirectional count of pedestrians & bikers (logarithmized)")
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE, main="Unidirectional count of pedestrians & bikers")
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE, main="Distribution of the unidirectional count of pedestrians & bikers")
join_zaehlung_wetter$UNIDIR_log <- log(join_zaehlung_wetter$UNIDIR)
histogram(~ join_zaehlung_wetter$UNIDIR_log, main = "Distribution of the unidirectional count of pedestrians & bikers (logarithmized)")
histogram(~ join_zaehlung_wetter$UNIDIR, xlim = c(0,250), breaks = 250, xlab = "Counted number of pedestrians & bikers per hour", labels = TRUE, main="Distribution of the unidirectional count of pedestrians & bikers", col="orange")
histogram(~ join_zaehlung_wetter$UNIDIR_log, main = "Distribution of the unidirectional count of pedestrians & bikers (logarithmized)", col="orange")
qplot(y = UNIDIR, x = precipitation, data = join_zaehlung_wetter, facets = ~ TAGESZEIT, col = TAGESZEIT)
qplot(y = UNIDIR, x = precipitation, data = join_zaehlung_wetter, facets = ~ FK_ZAEHLER, col = FK_ZAEHLER)
## {ggplot2} ##
qplot(y = UNIDIR, x = air_temperature, xlab = "Air temperature", data = join_zaehlung_wetter, facets = ~ month, col = month, ylim = c(0,250),alpha=I(0.05))
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month <- as.character(join_zaehlung_wetter$month)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-01"] <- 01 #"Januar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-02"] <- 02 #"Februar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-03"] <- 03 #"März"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-04"] <- 04 #"April"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-05"] <- 05#"Mai"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-06"] <- 06 #"Juni"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-07"] <- 07 #"July"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-08"] <- 08 #"August"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-09"] <- 09 #"September"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-10"] <- 10 #"Oktober"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-11"] <- 11 #"November"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-12"] <- 12 #"Dezember"
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month)
head(join_zaehlung_wetter)
qplot(y = UNIDIR, x = air_temperature, xlab = "Air temperature", data = join_zaehlung_wetter, facets = ~ month, col = month, ylim = c(0,250),alpha=I(0.05))
qplot(y = UNIDIR, x = air_temperature, xlab = "Air temperature", data = join_zaehlung_wetter, facets = ~ month, col = month,alpha=I(0.05))
# 1.1.1 Libraries
library(dplyr)
library(stringr)
library(dplyr)
library(ggplot2)
library(lattice)
#get working directory
getwd()
#read in data
zaehlung <- read.csv("2019_verkehrszaehlungen_werte_fussgaenger_velo_bereinigt.csv", sep=";", header = TRUE)
colnames(zaehlung)[1] <- "FK_ZAEHLER"
#structure of the dataset
str(zaehlung)
head(zaehlung)
wetter <- read.csv("wetter.csv", sep=";", header = TRUE)
#structure of the dataset
str(zaehlung)
head(zaehlung)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + TAGESZEIT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
#1.1.1 Prepare dataset pedestrians and bikers
##changing the FK_ZAEHLER to an indicator if bike or pedestrians are measured
zaehlung$FK_ZAEHLER <- as.character(zaehlung$FK_ZAEHLER)
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104443"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104446"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO09113499"] <- "velo"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO07091438"] <- "velo"
zaehlung$FK_ZAEHLER <- as.factor(zaehlung$FK_ZAEHLER)
zaehlung$FK_STANDORT <- as.factor(zaehlung$FK_STANDORT)
#only show hours not minutes
zaehlung$DATUM <- str_sub(zaehlung$DATUM, end = -4)
#getting the total of movements, independent from their direction
zaehlung[is.na(zaehlung)] <- 0
zaehlung[, "IN"] <- zaehlung[4]+zaehlung[6]
zaehlung[, "OUT"] <- zaehlung[5] + zaehlung[7]
zaehlung[, "UNIDIR"] <- zaehlung[4] + zaehlung [5] + zaehlung[6] +  zaehlung[7]
#
zaehlung[, "TAGESZEIT"] <-str_sub(zaehlung$DATUM, 12)
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "06"] <- "morgen"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "12"] <- "vormittag"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "18"] <- "nachmittag"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "24"] <- "abend"
zaehlung$TAGESZEIT <- as.factor(zaehlung$TAGESZEIT)
head(zaehlung)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + TAGESZEIT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + TAGESZEIT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
#1.1.2 Prepare dataset Weather
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
#apply(wetter, MARGIN = 2, FUN = anyNA)
#only show hours not minutes
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#calculate the mean of wind force, air temperature and humidity per hour, and the sum of precipitation per hour
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean)
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean)
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean)
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#old test code: aggregati <- aggregate(wetter$timestamp_cet)
#old test code: aggregati
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month <- as.character(join_zaehlung_wetter$month)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-01"] <- "01" #"Januar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-02"] <- "02" #"Februar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-03"] <- "03" #"März"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-04"] <- "04" #"April"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-05"] <- "05" #"Mai"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-06"] <- "06" #"Juni"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-07"] <- "07" #"July"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-08"] <- "08" #"August"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-09"] <- "09" #"September"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-10"] <- "10" #"Oktober"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-11"] <- "11" #"November"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-12"] <- "12" #"Dezember"
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month)
head(join_zaehlung_wetter)
qplot(y = UNIDIR, x = air_temperature, xlab = "Air temperature", data = join_zaehlung_wetter, facets = ~ month, col = month,alpha=I(0.05))
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month)
head(join_zaehlung_wetter)
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month <- as.character(join_zaehlung_wetter$month)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-01"] <- "01" #"Januar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-02"] <- "02" #"Februar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-03"] <- "03" #"März"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-04"] <- "04" #"April"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-05"] <- "05" #"Mai"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-06"] <- "06" #"Juni"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-07"] <- "07" #"July"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-08"] <- "08" #"August"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-09"] <- "09" #"September"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-10"] <- "10" #"Oktober"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-11"] <- "11" #"November"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-12"] <- "12" #"Dezember"
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month)
head(join_zaehlung_wetter)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + TAGESZEIT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
#1.1.2 Prepare dataset Weather
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
#apply(wetter, MARGIN = 2, FUN = anyNA)
#only show hours not minutes
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#calculate the mean of wind force, air temperature and humidity per hour, and the sum of precipitation per hour
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean)
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean)
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean)
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#old test code: aggregati <- aggregate(wetter$timestamp_cet)
#old test code: aggregati
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month <- as.character(join_zaehlung_wetter$month)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-01"] <- "01" #"Januar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-02"] <- "02" #"Februar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-03"] <- "03" #"März"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-04"] <- "04" #"April"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-05"] <- "05" #"Mai"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-06"] <- "06" #"Juni"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-07"] <- "07" #"July"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-08"] <- "08" #"August"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-09"] <- "09" #"September"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-10"] <- "10" #"Oktober"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-11"] <- "11" #"November"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-12"] <- "12" #"Dezember"
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month)
head(join_zaehlung_wetter)
# 1.1.1 Libraries
library(dplyr)
library(stringr)
library(dplyr)
library(ggplot2)
library(lattice)
#get working directory
getwd()
#read in data
zaehlung <- read.csv("2019_verkehrszaehlungen_werte_fussgaenger_velo_bereinigt.csv", sep=";", header = TRUE)
colnames(zaehlung)[1] <- "FK_ZAEHLER"
#structure of the dataset
str(zaehlung)
head(zaehlung)
wetter <- read.csv("wetter.csv", sep=";", header = TRUE)
#structure of the dataset
str(zaehlung)
head(zaehlung)
#1.1.1 Prepare dataset pedestrians and bikers
##changing the FK_ZAEHLER to an indicator if bike or pedestrians are measured
zaehlung$FK_ZAEHLER <- as.character(zaehlung$FK_ZAEHLER)
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104443"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104446"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO09113499"] <- "velo"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO07091438"] <- "velo"
zaehlung$FK_ZAEHLER <- as.factor(zaehlung$FK_ZAEHLER)
zaehlung$FK_STANDORT <- as.factor(zaehlung$FK_STANDORT)
#only show hours not minutes
zaehlung$DATUM <- str_sub(zaehlung$DATUM, end = -4)
#getting the total of movements, independent from their direction
zaehlung[is.na(zaehlung)] <- 0
zaehlung[, "IN"] <- zaehlung[4]+zaehlung[6]
zaehlung[, "OUT"] <- zaehlung[5] + zaehlung[7]
zaehlung[, "UNIDIR"] <- zaehlung[4] + zaehlung [5] + zaehlung[6] +  zaehlung[7]
#
zaehlung[, "TAGESZEIT"] <-str_sub(zaehlung$DATUM, 12)
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "06"] <- "morgen"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "12"] <- "vormittag"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "18"] <- "nachmittag"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "24"] <- "abend"
zaehlung$TAGESZEIT <- as.factor(zaehlung$TAGESZEIT)
head(zaehlung)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + TAGESZEIT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
#1.1.2 Prepare dataset Weather
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
#apply(wetter, MARGIN = 2, FUN = anyNA)
#only show hours not minutes
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#calculate the mean of wind force, air temperature and humidity per hour, and the sum of precipitation per hour
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean)
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean)
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean)
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#old test code: aggregati <- aggregate(wetter$timestamp_cet)
#old test code: aggregati
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month <- as.character(join_zaehlung_wetter$month)
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-01"] <- "01" #"Januar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-02"] <- "02" #"Februar"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-03"] <- "03" #"März"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-04"] <- "04" #"April"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-05"] <- "05" #"Mai"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-06"] <- "06" #"Juni"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-07"] <- "07" #"July"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-08"] <- "08" #"August"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-09"] <- "09" #"September"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-10"] <- "10" #"Oktober"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-11"] <- "11" #"November"
join_zaehlung_wetter$month[join_zaehlung_wetter$month <= "2019-12"] <- "12" #"Dezember"
join_zaehlung_wetter$month <- as.factor(join_zaehlung_wetter$month)
head(join_zaehlung_wetter)
#air temperature
ggplot(join_zaehlung_wetter, aes(air_temperature, UNIDIR)) + geom_point(alpha = 0.05, color="darkblue") + ggtitle("Does air temperature affect the number of bikers and pedestrians?") + xlab("Air temperature") + ylab("Total count of ped. + bikers")
# pch = 8,
# col = "darkblue",
# cex = 0.5,
# main = ,
# ylab =
# xlab = ,
# xlim = c(0,30)
#abline
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
ggplot(join_zaehlung_wetter, aes(air_temperature, UNIDIR)) + geom_point(alpha = 0.05, color="darkblue") + ggtitle("Does air temperature affect the number of bikers and pedestrians?") + xlab("Air temperature") + ylab("Total count of ped. + bikers") + ylim(c(0,250))
qplot(y = UNIDIR, x = air_temperature, xlab = "Air temperature", data = join_zaehlung_wetter, facets = ~ month, col = month,alpha=I(0.05))
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -11)
head(join_zaehlung_wetter)
join_zaehlung_wetter$month <- str_sub(join_zaehlung_wetter$DATUM, end = -7)
join_zaehlung_wetter$month <- as.character(join_zaehlung_wetter$month)
