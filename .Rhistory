aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean)
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean)
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean)
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#aggregati <- aggregate(wetter$timestamp_cet)
#aggregati
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
View(join_zaehlung_wetter)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM + TAGESZEIT, zaehlung, sum)
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
View(join_zaehlung_wetter)
# 1.1.1 Libraries
library(dplyr)
library(stringr)
library(dplyr)
#read in data
zaehlung <- read.csv("2019_verkehrszaehlungen_werte_fussgaenger_velo_bereinigt.csv", sep=";", header = TRUE)
colnames(zaehlung)[1] <- "FK_ZAEHLER"
#structure of the dataset
str(zaehlung)
head(zaehlung)
wetter <- read.csv("wetter.csv", sep=";", header = TRUE)
#structure of the dataset
str(zaehlung)
head(zaehlung)
#1.1.1 Prepare dataset pedestrians and bikers
##changing the FK_ZAEHLER to an indicator if bike or pedestrians are measured
zaehlung$FK_ZAEHLER <- as.character(zaehlung$FK_ZAEHLER)
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104443"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104446"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO09113499"] <- "velo"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO07091438"] <- "velo"
zaehlung$FK_ZAEHLER <- as.factor(zaehlung$FK_ZAEHLER)
zaehlung$FK_STANDORT <- as.factor(zaehlung$FK_STANDORT)
#only show hours not minutes
zaehlung$DATUM <- str_sub(zaehlung$DATUM, end = -4)
#getting the total of movements, independent from their direction
zaehlung[is.na(zaehlung)] <- 0
zaehlung[, "IN"] <- zaehlung[4]+zaehlung[6]
zaehlung[, "OUT"] <- zaehlung[5] + zaehlung[7]
zaehlung[, "UNIDIR"] <- zaehlung[4] + zaehlung [5] + zaehlung[6] +  zaehlung[7]
#
zaehlung[, "TAGESZEIT"] <-str_sub(zaehlung$DATUM, 12)
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "06"] <- "morgen"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "12"] <- "vormittag"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "18"] <- "nachmittag"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "24"] <- "abend"
head(zaehlung)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM + TAGESZEIT, zaehlung, sum)
#1.1.2 Prepare dataset Weather
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
#apply(wetter, MARGIN = 2, FUN = anyNA)
#only show hours not minutes
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#calculate the mean of wind force, air temperature and humidity per hour, and the sum of precipitation per hour
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean)
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean)
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean)
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#aggregati <- aggregate(wetter$timestamp_cet)
#aggregati
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
#1.1.3 joining both datasets together
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
View(join_zaehlung_wetter)
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM + Tageszeit + IN + OUT, zaehlung, sum)
setwd("C:/Users/salis/Documents/GitHub/r-bootcamp")
zaehlung <- read.csv("2019_verkehrszaehlungen_werte_fussgaenger_velo_bereinigt.csv", sep=";", header = TRUE)
colnames(zaehlung)[1] <- "FK_ZAEHLER"
##changing the FK_ZAEHLER to an indicator if bike or pedestrians are measured
zaehlung$FK_ZAEHLER <- as.character(zaehlung$FK_ZAEHLER)
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104443"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104446"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO09113499"] <- "velo"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO07091438"] <- "velo"
zaehlung$FK_ZAEHLER <- as.factor(zaehlung$FK_ZAEHLER)
zaehlung$FK_STANDORT <- as.factor(zaehlung$FK_STANDORT)
zaehlung$DATUM <- str_sub(zaehlung$DATUM, end = -4)
zaehlung[, "Tageszeit"] <-str_sub(zaehlung$DATUM, 12)
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "06"] <- "morgen"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "12"] <- "vormittag"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "18"] <- "nachmittag"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "24"] <- "abend"
#View(zaehlung)
#getting the total of movements, independent from their direction
zaehlung[is.na(zaehlung)] <- 0
zaehlung[, "IN"] <- zaehlung[4]+zaehlung[6]
zaehlung[, "OUT"] <- zaehlung[5] + zaehlung[7]
zaehlung[, "UNIDIR"] <- zaehlung[4] + zaehlung [5] + zaehlung[6] +  zaehlung[7]
head(zaehlung)
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM + Tageszeit + IN + OUT, zaehlung, sum)
wetter <- read.csv("wetter.csv", sep=";", header = TRUE)
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
#apply(wetter, MARGIN = 2, FUN = anyNA)
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#aggregati <- aggregate(wetter$timestamp_cet)
#aggregati
#joining both datasets
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
#joining both datasets
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
#joining both datasets
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM + Tageszeit + IN + OUT, zaehlung, sum)
library(dplyr)
library(stringr)
library(dplyr)
setwd("C:/Users/salis/Documents/GitHub/r-bootcamp")
zaehlung <- read.csv("2019_verkehrszaehlungen_werte_fussgaenger_velo_bereinigt.csv", sep=";", header = TRUE)
colnames(zaehlung)[1] <- "FK_ZAEHLER"
##changing the FK_ZAEHLER to an indicator if bike or pedestrians are measured
zaehlung$FK_ZAEHLER <- as.character(zaehlung$FK_ZAEHLER)
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104443"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104446"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO09113499"] <- "velo"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO07091438"] <- "velo"
zaehlung$FK_ZAEHLER <- as.factor(zaehlung$FK_ZAEHLER)
zaehlung$FK_STANDORT <- as.factor(zaehlung$FK_STANDORT)
zaehlung$DATUM <- str_sub(zaehlung$DATUM, end = -4)
zaehlung[, "Tageszeit"] <-str_sub(zaehlung$DATUM, 12)
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "06"] <- "morgen"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "12"] <- "vormittag"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "18"] <- "nachmittag"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "24"] <- "abend"
#View(zaehlung)
#getting the total of movements, independent from their direction
zaehlung[is.na(zaehlung)] <- 0
zaehlung[, "IN"] <- zaehlung[4]+zaehlung[6]
zaehlung[, "OUT"] <- zaehlung[5] + zaehlung[7]
zaehlung[, "UNIDIR"] <- zaehlung[4] + zaehlung [5] + zaehlung[6] +  zaehlung[7]
head(zaehlung)
wetter <- read.csv("wetter.csv", sep=";", header = TRUE)
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
#apply(wetter, MARGIN = 2, FUN = anyNA)
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#aggregati <- aggregate(wetter$timestamp_cet)
#aggregati
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM + Tageszeit + IN + OUT, zaehlung, sum)
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM + Tageszeit + IN + OUT, zaehlung, sum)
head(aggregated_listFK)
setwd("C:/Users/salis/Documents/GitHub/r-bootcamp")
zaehlung <- read.csv("2019_verkehrszaehlungen_werte_fussgaenger_velo_bereinigt.csv", sep=";", header = TRUE)
colnames(zaehlung)[1] <- "FK_ZAEHLER"
##changing the FK_ZAEHLER to an indicator if bike or pedestrians are measured
zaehlung$FK_ZAEHLER <- as.character(zaehlung$FK_ZAEHLER)
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104443"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104446"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO09113499"] <- "velo"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO07091438"] <- "velo"
zaehlung$FK_ZAEHLER <- as.factor(zaehlung$FK_ZAEHLER)
zaehlung$FK_STANDORT <- as.factor(zaehlung$FK_STANDORT)
zaehlung$DATUM <- str_sub(zaehlung$DATUM, end = -4)
zaehlung[, "Tageszeit"] <-str_sub(zaehlung$DATUM, 12)
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "06"] <- "morgen"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "12"] <- "vormittag"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "18"] <- "nachmittag"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "24"] <- "abend"
#View(zaehlung)
#getting the total of movements, independent from their direction
zaehlung[is.na(zaehlung)] <- 0
zaehlung[, "IN"] <- zaehlung[4]+zaehlung[6]
zaehlung[, "OUT"] <- zaehlung[5] + zaehlung[7]
zaehlung[, "UNIDIR"] <- zaehlung[4] + zaehlung [5] + zaehlung[6] +  zaehlung[7]
head(zaehlung)
wetter <- read.csv("wetter.csv", sep=";", header = TRUE)
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
#apply(wetter, MARGIN = 2, FUN = anyNA)
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#aggregati <- aggregate(wetter$timestamp_cet)
#aggregati
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
head(aggregated_listFK)
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + OST + NORD + FK_STANDORT + DATUM + Tageszeit, zaehlung, sum)
head(aggregated_listFK)
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + Tageszeit + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
head(aggregated_listFK)
#joining both datasets
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
View(join_zaehlung_wetter)
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + Tageszeit + IN + OUT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
head(aggregated_listFK)
#joining both datasets
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
View(join_zaehlung_wetter)
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + Tageszeit + IN + NORD + FK_STANDORT + DATUM, zaehlung, sum)
head(aggregated_listFK)
#joining both datasets
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
View(join_zaehlung_wetter)
setwd("C:/Users/salis/Documents/GitHub/r-bootcamp")
zaehlung <- read.csv("2019_verkehrszaehlungen_werte_fussgaenger_velo_bereinigt.csv", sep=";", header = TRUE)
colnames(zaehlung)[1] <- "FK_ZAEHLER"
##changing the FK_ZAEHLER to an indicator if bike or pedestrians are measured
zaehlung$FK_ZAEHLER <- as.character(zaehlung$FK_ZAEHLER)
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104443"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104446"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO09113499"] <- "velo"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO07091438"] <- "velo"
zaehlung$FK_ZAEHLER <- as.factor(zaehlung$FK_ZAEHLER)
zaehlung$FK_STANDORT <- as.factor(zaehlung$FK_STANDORT)
zaehlung$DATUM <- str_sub(zaehlung$DATUM, end = -4)
zaehlung[, "Tageszeit"] <-str_sub(zaehlung$DATUM, 12)
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "06"] <- "morgen"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "12"] <- "vormittag"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "18"] <- "nachmittag"
zaehlung$Tageszeit[zaehlung$Tageszeit  <= "24"] <- "abend"
#View(zaehlung)
#getting the total of movements, independent from their direction
zaehlung[is.na(zaehlung)] <- 0
zaehlung[, "IN"] <- zaehlung[4]+zaehlung[6]
zaehlung[, "OUT"] <- zaehlung[5] + zaehlung[7]
zaehlung[, "UNIDIR"] <- zaehlung[4] + zaehlung [5] + zaehlung[6] +  zaehlung[7]
head(zaehlung)
wetter <- read.csv("wetter.csv", sep=";", header = TRUE)
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
#apply(wetter, MARGIN = 2, FUN = anyNA)
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean, round(digits = 2))
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#aggregati <- aggregate(wetter$timestamp_cet)
#aggregati
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + Tageszeit + IN + NORD + FK_STANDORT + DATUM, zaehlung, sum)
head(aggregated_listFK)
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + Tageszeit + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
head(aggregated_listFK)
#joining both datasets
join_zaehlung_wetter <- left_join(aggregated_listFK, aggregated_wetter_Wind_Temp_Prec_Hum, by = c("DATUM" = "timestamp_cet"))
head(join_zaehlung_wetter)
View(join_zaehlung_wetter)
plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
#Model
boxplot(air_temperature ~ FK_ZAEHLER + FK_STANDORT, data = join_zaehlung_wetter, main = "Something", col = "lightgrey")
boxplot(air_temperature ~ FK_ZAEHLER, data = join_zaehlung_wetter, main = "Something", col = "lightgrey")
boxplot(precipitation ~ UNIDIR, data = join_zaehlung_wetter, main = "Something", col = "lightgrey")
boxplot(precipitation ~ FK_STANDORT, data = join_zaehlung_wetter, main = "Something", col = "lightgrey")
boxplot(humidity ~ UNIDIR, data = join_zaehlung_wetter, main = "Something", col = "lightgrey")
lm.join <- lm(UNIDIR ~ FK_ZAEHLER, data = join_zaehlung_wetter)
coef(lm.join)
plot(humidity ~ UNIDIR, data = join_zaehlung_wetter)
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter)
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = ".")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = ".",
col = "lightblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = ".",
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 1,
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 2,
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 3,
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 4,
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 5,
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 6,
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 7,
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue")
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 2)
#abline
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5)
#abline
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does temperature make a different to the count of bikers and pedestrians?")
#abline
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(FK_ZAEHLER ~ UNIDIR + air_temperature, data = join_zaehlung_wetter)
plot(FK_ZAEHLER ~ UNIDIR, data = join_zaehlung_wetter)
plot(UNIDIR ~ humidity, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does temperature make a different to the count of bikers and pedestrians?")
plot(UNIDIR ~ precipitation, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does humidity make a different to the count of bikers and pedestrians?")
plot(UNIDIR ~ precipitation, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does precipitation make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = "Precipitation in ml")
plot(UNIDIR ~ humidity, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does humidity make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = " Humidity in ??")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does temperature make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = "Air temperature")
#abline
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ wind_force_avg_10min, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does wind force make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = "Wind force")
plot(UNIDIR ~ wind_force_avg_10min, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does wind force make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = "Wind force",
type = 1)
plot(UNIDIR ~ wind_force_avg_10min, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does wind force make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = "Wind force",
type = "b")
# 1.1.1 Libraries
library(dplyr)
library(stringr)
library(dplyr)
#get working directory
getwd()
#read in data
zaehlung <- read.csv("2019_verkehrszaehlungen_werte_fussgaenger_velo_bereinigt.csv", sep=";", header = TRUE)
colnames(zaehlung)[1] <- "FK_ZAEHLER"
#structure of the dataset
str(zaehlung)
head(zaehlung)
wetter <- read.csv("wetter.csv", sep=";", header = TRUE)
#structure of the dataset
str(zaehlung)
head(zaehlung)
#1.1.1 Prepare dataset pedestrians and bikers
##changing the FK_ZAEHLER to an indicator if bike or pedestrians are measured
zaehlung$FK_ZAEHLER <- as.character(zaehlung$FK_ZAEHLER)
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104443"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "U15G3104446"] <- "fussgaenger"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO09113499"] <- "velo"
zaehlung$FK_ZAEHLER[zaehlung$FK_ZAEHLER == "ECO07091438"] <- "velo"
zaehlung$FK_ZAEHLER <- as.factor(zaehlung$FK_ZAEHLER)
zaehlung$FK_STANDORT <- as.factor(zaehlung$FK_STANDORT)
#only show hours not minutes
zaehlung$DATUM <- str_sub(zaehlung$DATUM, end = -4)
#getting the total of movements, independent from their direction
zaehlung[is.na(zaehlung)] <- 0
zaehlung[, "IN"] <- zaehlung[4]+zaehlung[6]
zaehlung[, "OUT"] <- zaehlung[5] + zaehlung[7]
zaehlung[, "UNIDIR"] <- zaehlung[4] + zaehlung [5] + zaehlung[6] +  zaehlung[7]
#
zaehlung[, "TAGESZEIT"] <-str_sub(zaehlung$DATUM, 12)
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "06"] <- "morgen"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "12"] <- "vormittag"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "18"] <- "nachmittag"
zaehlung$TAGESZEIT[zaehlung$TAGESZEIT  <= "24"] <- "abend"
head(zaehlung)
#calculate the total of movements of pedestrians and bikers hourly
aggregated_listFK <- aggregate(UNIDIR ~ FK_ZAEHLER + TAGESZEIT + OST + NORD + FK_STANDORT + DATUM, zaehlung, sum)
#1.1.2 Prepare dataset Weather
#wetter$wind_force_avg_10min <- as.factor(wetter$wind_force_avg_10min)
#apply(wetter, MARGIN = 2, FUN = anyNA)
#only show hours not minutes
wetter$timestamp_cet <- str_sub(wetter$timestamp_cet, end = -7)
#calculate the mean of wind force, air temperature and humidity per hour, and the sum of precipitation per hour
#aggregated_listWETTER <- aggregate(timestamp_cet ~ wind_force_avg_10min + air_temperature + precipitation, wetter, FUN = "mean")
aggregated_Wind <- aggregate(wind_force_avg_10min ~ timestamp_cet, wetter, FUN = mean)
aggregated_Temp <- aggregate(air_temperature ~ timestamp_cet, wetter, FUN = mean)
aggregated_Prec <- aggregate(precipitation ~ timestamp_cet, wetter, sum)
aggregated_Hum <- aggregate(humidity ~ timestamp_cet, wetter, FUN = mean)
#aggregate <- wetter$aggregated_Wind, wetter$aggregated_Temp, wetter$aggregated_Prec
aggregated_wetter_Wind_Temp <- left_join(aggregated_Wind, aggregated_Temp, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec <- left_join(aggregated_wetter_Wind_Temp, aggregated_Prec, by = "timestamp_cet")
aggregated_wetter_Wind_Temp_Prec_Hum <- left_join(aggregated_wetter_Wind_Temp_Prec, aggregated_Hum, by = "timestamp_cet")
head(aggregated_wetter_Wind_Temp_Prec_Hum)
#View(aggregated_wetter_Wind_Temp_Prec)
#aggregati <- aggregate(wetter$timestamp_cet)
#aggregati
plot(FK_ZAEHLER ~ air_temperature, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does temperature make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = "Air temperature")
#abline
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
plot(UNIDIR ~ air_temperature, data = join_zaehlung_wetter,
pch = 8,
col = "darkblue",
cex = 0.5,
main = "Does temperature make a different to the count of bikers and pedestrians?",
ylab = "Total count of ped. + bikers",
xlab = "Air temperature")
#abline
#plot(aggregated_wetter_Wind_Temp_Prec_Hum$air_temperature, aggregated_wetter_Wind_Temp_Prec_Hum$UNIDIR, main = "...")
